{
  "abstract": [
    {
      "text": "Receive notifications and authorization requests for sensitive operations by creating an Endpoint Security client for your app.",
      "type": "text"
    }
  ],
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.endpointsecurity/documentation/EndpointSecurity"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "occ",
    "url": "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/monitoring-system-events-with-endpoint-security"
  },
  "kind": "article",
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "modules": [
      {
        "name": "Endpoint Security"
      }
    ],
    "platforms": [
      {
        "beta": false,
        "introducedAt": "11.0",
        "name": "macOS"
      },
      {
        "beta": false,
        "introducedAt": "13.0",
        "name": "Xcode"
      }
    ],
    "role": "sampleCode",
    "roleHeading": "Sample Code",
    "title": "Monitoring System Events with Endpoint Security"
  },
  "primaryContentSections": [
    {
      "content": [
        {
          "anchor": "Overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "This sample code project is associated with WWDC 2020 session ",
                  "type": "text"
                },
                {
                  "identifier": "http://developer.apple.com/wwdc20/10159",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ". For further information, see WWDC 2019 session ",
                  "type": "text"
                },
                {
                  "identifier": "https://developer.apple.com/videos/play/wwdc2019/702/",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ".",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "Note",
          "style": "note",
          "type": "aside"
        },
        {
          "inlineContent": [
            {
              "code": "SampleEndpointApp",
              "type": "codeVoice"
            },
            {
              "text": " is a minimal system extension that shows how to use the Endpoint Security library. You can configure the extension to either receive notifications of events after they occur, or to allow or deny in-flight events.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "Configure-the-Sample-Code-Project",
          "level": 3,
          "text": "Configure the Sample Code Project",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "This sample code project only runs on macOS 11 and later.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "You can build the project to receive either ",
              "type": "text"
            },
            {
              "code": "NOTIFY",
              "type": "codeVoice"
            },
            {
              "text": " or ",
              "type": "text"
            },
            {
              "code": "AUTH",
              "type": "codeVoice"
            },
            {
              "text": " events. You control this in the Xcode file inspector.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "For ",
                      "type": "text"
                    },
                    {
                      "code": "NOTIFY",
                      "type": "codeVoice"
                    },
                    {
                      "text": " events: Select ",
                      "type": "text"
                    },
                    {
                      "code": "notify_demo.c",
                      "type": "codeVoice"
                    },
                    {
                      "text": " and, in the file inspector, select the “Extension” target in the “Target Membership” section.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "For ",
                      "type": "text"
                    },
                    {
                      "code": "AUTH",
                      "type": "codeVoice"
                    },
                    {
                      "text": " events: Select ",
                      "type": "text"
                    },
                    {
                      "code": "auth_demo.c",
                      "type": "codeVoice"
                    },
                    {
                      "text": " and, in the file inspector, select the “Extension” target in the “Target Membership” section.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "unorderedList"
        },
        {
          "inlineContent": [
            {
              "text": "You must set the “Extension” target membership on exactly one of these two files.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "To install the system extension:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Generate your Developer ID certificate. Refer to ",
                      "type": "text"
                    },
                    {
                      "identifier": "https://developer.apple.com/developer-id/",
                      "isActive": true,
                      "type": "reference"
                    },
                    {
                      "text": " for instructions.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Request the Endpoint Security entitlement; see ",
                      "type": "text"
                    },
                    {
                      "identifier": "https://developer.apple.com/system-extensions/",
                      "isActive": true,
                      "type": "reference"
                    },
                    {
                      "text": ".",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Xcode, build and sign both the app and the extension with your Developer provisioning profile.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Copy the app to ",
                      "type": "text"
                    },
                    {
                      "code": "/Applications",
                      "type": "codeVoice"
                    },
                    {
                      "text": ", and launch it from there. You can only install System Extensions for apps launched from the ",
                      "type": "text"
                    },
                    {
                      "code": "/Applications",
                      "type": "codeVoice"
                    },
                    {
                      "text": " folder.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Click “Install Extension” and follow the prompts to allow the extension to launch.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In System Preferences, choose Security & Privacy > Privacy. Scroll to “Full Disk Access” and grant permission to use the extension.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Terminal, run ",
                      "type": "text"
                    },
                    {
                      "code": "systemextensionsctl list",
                      "type": "codeVoice"
                    },
                    {
                      "text": " to verify that the system extension is activated.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Terminal, run ",
                      "type": "text"
                    },
                    {
                      "code": "sudo launchctl list <Team-ID>.com.example.apple-samplecode.SampleEndpointApp.Extension",
                      "type": "codeVoice"
                    },
                    {
                      "text": " to verify that the system extension is running.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "orderedList"
        },
        {
          "inlineContent": [
            {
              "text": "After installing the system extension, you can monitor its activity as follows:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "If you built ",
                      "type": "text"
                    },
                    {
                      "code": "notify_demo.c",
                      "type": "codeVoice"
                    },
                    {
                      "text": ", open the system log to see log messages every time a process executes, forks, or exits.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "If you built ",
                      "type": "text"
                    },
                    {
                      "code": "auth_demo.c",
                      "type": "codeVoice"
                    },
                    {
                      "text": ", the extension blocks any operations on an EICAR test file on your system. The extension also prevents writing to any file that starts with the read-only prefix, defined in ",
                      "type": "text"
                    },
                    {
                      "code": "auth_demo.c",
                      "type": "codeVoice"
                    },
                    {
                      "text": " as ",
                      "type": "text"
                    },
                    {
                      "code": "/usr/bin/local",
                      "type": "codeVoice"
                    },
                    {
                      "text": ". For process executions, the extension denies new execs that use the signing ID ",
                      "type": "text"
                    },
                    {
                      "code": "com.apple.TextEdit",
                      "type": "codeVoice"
                    },
                    {
                      "text": "; this means the extension will prevent the default ",
                      "type": "text"
                    },
                    {
                      "code": "TextEdit.app",
                      "type": "codeVoice"
                    },
                    {
                      "text": " from launching.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "unorderedList"
        },
        {
          "inlineContent": [
            {
              "text": "To  uninstall the system extension:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Terminal, run ",
                      "type": "text"
                    },
                    {
                      "code": "systemextensionsctl uninstall <Team-ID> com.example.apple-samplecode.SampleEndpointApp.Extension",
                      "type": "codeVoice"
                    },
                    {
                      "text": ".",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Alternatively, drag the sample app from the ",
                      "type": "text"
                    },
                    {
                      "code": "/Applications",
                      "type": "codeVoice"
                    },
                    {
                      "text": " folder to the Trash.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "orderedList"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "70ea78a173bc/MonitoringSystemEventsWithEndpointSecurity.zip": {
      "checksum": "70ea78a173bc933126e31c8e3d91c103e34c1bfcf15057036b1c700facdac18fbf5187476d9cd93de6314bcf2b5273c5d039992c19fd794969c6c472c39e6a01",
      "identifier": "70ea78a173bc/MonitoringSystemEventsWithEndpointSecurity.zip",
      "type": "download",
      "url": "https://docs-assets.developer.apple.com/published/70ea78a173bc/MonitoringSystemEventsWithEndpointSecurity.zip"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "abstract": [
        {
          "text": "",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "role": "overview",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    },
    "doc://com.apple.endpointsecurity/documentation/EndpointSecurity": {
      "abstract": [
        {
          "text": "Develop system extensions that enhance user security.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.endpointsecurity/documentation/EndpointSecurity",
      "kind": "symbol",
      "role": "collection",
      "title": "Endpoint Security",
      "type": "topic",
      "url": "/documentation/endpointsecurity"
    },
    "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/client": {
      "abstract": [
        {
          "text": "An opaque type that maintains Endpoint Security client state, and functions related to this type.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/client",
      "kind": "article",
      "role": "collectionGroup",
      "title": "Client",
      "type": "topic",
      "url": "/documentation/endpointsecurity/client"
    },
    "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/event-types": {
      "abstract": [
        {
          "text": "Types used by messages to deliver details specific to different kinds of Endpoint Security events.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/event-types",
      "kind": "article",
      "role": "collectionGroup",
      "title": "Event Types",
      "type": "topic",
      "url": "/documentation/endpointsecurity/event-types"
    },
    "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/message": {
      "abstract": [
        {
          "text": "A type used by Endpoint Security to notify your client when a monitored action occurs.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/message",
      "kind": "article",
      "role": "collectionGroup",
      "title": "Message",
      "type": "topic",
      "url": "/documentation/endpointsecurity/message"
    },
    "http://developer.apple.com/wwdc20/10159": {
      "identifier": "http://developer.apple.com/wwdc20/10159",
      "title": "10159: Build an Endpoint Security App",
      "titleInlineContent": [
        {
          "text": "10159: Build an Endpoint Security App",
          "type": "text"
        }
      ],
      "type": "link",
      "url": "http://developer.apple.com/wwdc20/10159"
    },
    "https://developer.apple.com/developer-id/": {
      "identifier": "https://developer.apple.com/developer-id/",
      "title": "Developer ID",
      "titleInlineContent": [
        {
          "text": "Developer ID",
          "type": "text"
        }
      ],
      "type": "link",
      "url": "https://developer.apple.com/developer-id/"
    },
    "https://developer.apple.com/system-extensions/": {
      "identifier": "https://developer.apple.com/system-extensions/",
      "title": "System Extensions and DriverKit",
      "titleInlineContent": [
        {
          "text": "System Extensions and DriverKit",
          "type": "text"
        }
      ],
      "type": "link",
      "url": "https://developer.apple.com/system-extensions/"
    },
    "https://developer.apple.com/videos/play/wwdc2019/702/": {
      "identifier": "https://developer.apple.com/videos/play/wwdc2019/702/",
      "title": "702: System Extensions and DriverKit",
      "titleInlineContent": [
        {
          "text": "702: System Extensions and DriverKit",
          "type": "text"
        }
      ],
      "type": "link",
      "url": "https://developer.apple.com/videos/play/wwdc2019/702/"
    }
  },
  "sampleCodeDownload": {
    "action": {
      "identifier": "70ea78a173bc/MonitoringSystemEventsWithEndpointSecurity.zip",
      "isActive": true,
      "overridingTitle": "Download",
      "type": "reference"
    },
    "kind": "sampleDownload"
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "seeAlsoSections": [
    {
      "anchor": "Event-Monitoring",
      "generated": true,
      "identifiers": [
        "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/client",
        "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/message",
        "doc://com.apple.endpointsecurity/documentation/EndpointSecurity/event-types"
      ],
      "title": "Event Monitoring"
    }
  ],
  "variants": [
    {
      "paths": [
        "/documentation/endpointsecurity/monitoring-system-events-with-endpoint-security"
      ],
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ]
    }
  ]
}
