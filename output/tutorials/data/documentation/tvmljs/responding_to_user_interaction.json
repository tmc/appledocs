{
  "abstract": [
    {
      "text": "Update onscreen information by adding event listeners to your Apple TV app.",
      "type": "text"
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/tvmljs"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "data",
    "url": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction"
  },
  "kind": "article",
  "legacy_identifier": 3110638,
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "modules": [
      {
        "name": "TVMLKit JS"
      }
    ],
    "platforms": [
      {
        "current": "18.4",
        "introducedAt": "12.1",
        "name": "tvOS"
      },
      {
        "current": "16.3",
        "introducedAt": "11.2",
        "name": "Xcode"
      }
    ],
    "role": "sampleCode",
    "roleHeading": "Sample Code",
    "title": "Responding to User Interaction"
  },
  "primaryContentSections": [
    {
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "As the user navigates to a menu item along the top of the screen, the screen updates with information related to that menu item. This app shows you how to use events to update the screen when the user moves to a menu item, but doesn’t select the item.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "3400759",
          "level": 3,
          "text": "Configure the Sample Code Project",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Before running the app, set up a local server on your machine:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Finder, navigate to the Incorporating Event Listeners directory inside of the Incorporating Event Listeners directory.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Terminal, enter ",
                      "type": "text"
                    },
                    {
                      "code": "cd",
                      "type": "codeVoice"
                    },
                    {
                      "text": ", followed by a space.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Drag the Incorporating Event Listeners folder from the Finder window into the Terminal window, and press Return. The current directory changes to that folder.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "In Terminal, enter ",
                      "type": "text"
                    },
                    {
                      "code": "ruby -run -ehttpd . -p9001",
                      "type": "codeVoice"
                    },
                    {
                      "text": " to run the server.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Build and run the app in Apple TV Simulator.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "orderedList"
        },
        {
          "inlineContent": [
            {
              "text": "After testing the sample app in Apple TV Simulator, you can quit the local server by pressing Control-C in Terminal or closing the Terminal window.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "3400760",
          "level": 3,
          "text": "Add URL Information to the menuBar Template Code",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Add the ",
              "type": "text"
            },
            {
              "code": "selectTargetURL",
              "type": "codeVoice"
            },
            {
              "text": " attribute to each ",
              "type": "text"
            },
            {
              "code": "menuItem",
              "type": "codeVoice"
            },
            {
              "text": " element inside of the ",
              "type": "text"
            },
            {
              "code": "menuBarTemplate",
              "type": "codeVoice"
            },
            {
              "text": ". As the user moves between menu items, an event fires in order to update the onscreen information. The ",
              "type": "text"
            },
            {
              "code": "selectTargetURL",
              "type": "codeVoice"
            },
            {
              "text": " attribute identifies the location of the TVML page associated with the highlighted menu item. An example of a formatted menu item follows:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "<menuItem selectTargetURL=\"Server/Templates/firstmenutabpage.xml\">",
            "    <title>Tab 1</title>",
            "</menuItem>"
          ],
          "metadata": {
            "anchor": "3400750",
            "title": "Listing 1"
          },
          "syntax": "swift",
          "type": "codeListing"
        },
        {
          "anchor": "3400761",
          "level": 3,
          "text": "Set Up the Event Listeners",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Use the ",
              "type": "text"
            },
            {
              "code": "XMLHttpRequest",
              "type": "codeVoice"
            },
            {
              "text": " function to load the ",
              "type": "text"
            },
            {
              "code": "menuBar",
              "type": "codeVoice"
            },
            {
              "text": " template and then add an event listener to the document using the JavaScript ",
              "type": "text"
            },
            {
              "code": "addEventListener",
              "type": "codeVoice"
            },
            {
              "text": " function. The event listener notifies the app when the user moves to a new menu item. The app calls the user-defined ",
              "type": "text"
            },
            {
              "code": "handleSelectEvent",
              "type": "codeVoice"
            },
            {
              "text": " function and automatically sends all of the the events to the function.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "if (request.status == 200) {",
            "    var document = request.responseXML;",
            "    document.addEventListener(\"select\", handleSelectEvent);",
            "    navigationDocument.replaceDocument(document, loadingDocument)"
          ],
          "metadata": {
            "anchor": "3400752",
            "title": "Listing 2"
          },
          "syntax": "javascript",
          "type": "codeListing"
        },
        {
          "anchor": "3400762",
          "level": 3,
          "text": "Respond to an Event",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Use the ",
              "type": "text"
            },
            {
              "code": "handleSelectEvent",
              "type": "codeVoice"
            },
            {
              "text": " function to verify that the event fired for the correct TVML element. The event’s ",
              "type": "text"
            },
            {
              "code": "target",
              "type": "codeVoice"
            },
            {
              "text": " property contains the highlighted element. The function then verifies that the highlighted element contains the ",
              "type": "text"
            },
            {
              "code": "selectTargetURL",
              "type": "codeVoice"
            },
            {
              "text": " attribute. If the highlighted element is also a ",
              "type": "text"
            },
            {
              "code": "menuItem",
              "type": "codeVoice"
            },
            {
              "text": " element and not a different element with the ",
              "type": "text"
            },
            {
              "code": "selectTargetURL",
              "type": "codeVoice"
            },
            {
              "text": " attribute, the function calls the ",
              "type": "text"
            },
            {
              "code": "updateMenuItem",
              "type": "codeVoice"
            },
            {
              "text": " function, which will update the displayed document, that is, the information associated with the highlighted menu item.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "function handleSelectEvent(event) {",
            "    var selectedElement = event.target;",
            "    ",
            "    var targetURL = selectedElement.getAttribute(\"selectTargetURL\");",
            "    if (!targetURL) {",
            "        return;",
            "    }",
            "    targetURL = baseURL + targetURL;",
            "    ",
            "    if (selectedElement.tagName == \"menuItem\") {",
            "        updateMenuItem(selectedElement, targetURL);",
            "    }",
            "    else {",
            "        loadAndPushDocument(targetURL);",
            "    }",
            "}"
          ],
          "metadata": {
            "anchor": "3400754",
            "title": "Listing 3"
          },
          "syntax": "javascript",
          "type": "codeListing"
        },
        {
          "anchor": "3400763",
          "level": 3,
          "text": "Update the Document",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Use the ",
              "type": "text"
            },
            {
              "code": "updateMenuItem",
              "type": "codeVoice"
            },
            {
              "text": " function to load the new document from the server. After loading the new document, retrieve the menu item’s parent node and the ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.documentation/documentation/tvmljs/menubardocument",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " object. Finally, associate the new document to the ",
              "type": "text"
            },
            {
              "code": "menuItem",
              "type": "codeVoice"
            },
            {
              "text": " element using the ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.documentation/documentation/tvmljs/menubardocument/1627374-setdocument",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": ". This displays the document associated with the menu item.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "function updateMenuItem(menuItem, url) {",
            "    var request = new XMLHttpRequest();",
            "    request.open(\"GET\", url, true);",
            "    ",
            "    request.onreadystatechange = function() {",
            "        if (request.status == 200) {",
            "            var document = request.responseXML;",
            "            var menuItemDocument = menuItem.parentNode.getFeature(\"MenuBarDocument\");",
            "            menuItemDocument.setDocument(document, menuItem)",
            "        }",
            "    };",
            "    ",
            "    request.send();",
            "}"
          ],
          "metadata": {
            "anchor": "3400756",
            "title": "Listing 4"
          },
          "syntax": "javascript",
          "type": "codeListing"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/technologies": {
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    },
    "doc://com.apple.documentation/documentation/tvmljs": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs",
      "kind": "symbol",
      "role": "collection",
      "title": "TVMLKit JS",
      "type": "topic",
      "url": "/documentation/tvmljs"
    },
    "doc://com.apple.documentation/documentation/tvmljs/app": {
      "abstract": [
        {
          "text": "An object that provides access to—and a means to respond to—app life-cycle events.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/app",
      "kind": "symbol",
      "role": "symbol",
      "title": "App",
      "type": "topic",
      "url": "/documentation/tvmljs/app"
    },
    "doc://com.apple.documentation/documentation/tvmljs/eventlistenerobject": {
      "abstract": [
        {
          "text": "An object that communicates events and allows other objects to add themselves as listeners.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/eventlistenerobject",
      "kind": "symbol",
      "role": "symbol",
      "title": "EventListenerObject",
      "type": "topic",
      "url": "/documentation/tvmljs/eventlistenerobject"
    },
    "doc://com.apple.documentation/documentation/tvmljs/menubardocument": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/menubardocument",
      "kind": "symbol",
      "role": "symbol",
      "title": "MenuBarDocument",
      "type": "topic",
      "url": "/documentation/tvmljs/menubardocument"
    },
    "doc://com.apple.documentation/documentation/tvmljs/menubardocument/1627374-setdocument": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/menubardocument/1627374-setdocument",
      "kind": "symbol",
      "role": "symbol",
      "title": "setDocument",
      "type": "topic",
      "url": "/documentation/tvmljs/menubardocument/1627374-setdocument"
    },
    "doc://com.apple.documentation/documentation/tvmljs/navigationdocument": {
      "abstract": [
        {
          "text": "A document stack that holds the individual TVML documents for a client-server app.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/navigationdocument",
      "kind": "symbol",
      "role": "symbol",
      "title": "NavigationDocument",
      "type": "topic",
      "url": "/documentation/tvmljs/navigationdocument"
    },
    "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction": {
      "abstract": [
        {
          "text": "Update onscreen information by adding event listeners to your Apple TV app.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction",
      "kind": "article",
      "role": "sampleCode",
      "title": "Responding to User Interaction",
      "type": "topic",
      "url": "/documentation/tvmljs/responding_to_user_interaction"
    },
    "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400750": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400750",
      "kind": "article",
      "role": "codeListing",
      "title": "Listing 1",
      "type": "section",
      "url": "/documentation/tvmljs/responding_to_user_interaction#3400750"
    },
    "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400752": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400752",
      "kind": "article",
      "role": "codeListing",
      "title": "Listing 2",
      "type": "section",
      "url": "/documentation/tvmljs/responding_to_user_interaction#3400752"
    },
    "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400754": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400754",
      "kind": "article",
      "role": "codeListing",
      "title": "Listing 3",
      "type": "section",
      "url": "/documentation/tvmljs/responding_to_user_interaction#3400754"
    },
    "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400756": {
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/responding_to_user_interaction#3400756",
      "kind": "article",
      "role": "codeListing",
      "title": "Listing 4",
      "type": "section",
      "url": "/documentation/tvmljs/responding_to_user_interaction#3400756"
    },
    "doc://com.apple.documentation/documentation/tvmljs/userdefaults": {
      "abstract": [
        {
          "text": "An object that contains the app's default preferences.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/tvmljs/userdefaults",
      "kind": "symbol",
      "role": "symbol",
      "title": "UserDefaults",
      "type": "topic",
      "url": "/documentation/tvmljs/userdefaults"
    },
    "https://docs-assets.developer.apple.com/published/b2db8f4d43/RespondingToUserInteraction.zip": {
      "checksum": "34ddba4a80f58a6fc84b30e23acb87fbec47a726659ae6ec715c64f3a8a1c0032b9fcd2a55d825ed5d87d74083209125c823680e3e69cb25ac6beba16a2d831f",
      "identifier": "https://docs-assets.developer.apple.com/published/b2db8f4d43/RespondingToUserInteraction.zip",
      "type": "download",
      "url": "https://docs-assets.developer.apple.com/published/b2db8f4d43/RespondingToUserInteraction.zip"
    }
  },
  "sampleCodeDownload": {
    "action": {
      "identifier": "https://docs-assets.developer.apple.com/published/b2db8f4d43/RespondingToUserInteraction.zip",
      "isActive": true,
      "overridingTitle": "Download",
      "type": "reference"
    }
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "seeAlsoSections": [
    {
      "generated": true,
      "identifiers": [
        "doc://com.apple.documentation/documentation/tvmljs/app",
        "doc://com.apple.documentation/documentation/tvmljs/userdefaults",
        "doc://com.apple.documentation/documentation/tvmljs/navigationdocument",
        "doc://com.apple.documentation/documentation/tvmljs/eventlistenerobject"
      ],
      "title": "App Initialization"
    }
  ],
  "variants": [
    {
      "paths": [
        "documentation/tvmljs/responding_to_user_interaction"
      ],
      "traits": [
        {
          "interfaceLanguage": "data"
        }
      ]
    }
  ]
}
