{
  "abstract": [
    {
      "text": "Defines a pointer to a data transfer callback function that transfers profile data from the format for embedded profiles to disk file format or vice versa.",
      "type": "text"
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.documentation/documentation/applicationservices",
        "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "swift",
    "url": "doc://com.apple.documentation/documentation/applicationservices/cmflattenprocptr"
  },
  "kind": "symbol",
  "legacy_identifier": 1462367,
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "externalID": "c:@T@CMFlattenProcPtr",
    "fragments": [
      {
        "kind": "text",
        "text": "typealias "
      },
      {
        "kind": "identifier",
        "text": "CMFlattenProcPtr"
      }
    ],
    "modules": [
      {
        "name": "Application Services"
      }
    ],
    "platforms": [
      {
        "current": "15.4",
        "introducedAt": "10.0",
        "name": "macOS"
      }
    ],
    "role": "symbol",
    "roleHeading": "Type Alias",
    "symbolKind": "tdef",
    "title": "CMFlattenProcPtr"
  },
  "primaryContentSections": [
    {
      "declarations": [
        {
          "languages": [
            "swift"
          ],
          "platforms": [
            "macOS"
          ],
          "tokens": [
            {
              "kind": "keyword",
              "text": "typealias"
            },
            {
              "kind": "text",
              "text": " "
            },
            {
              "kind": "identifier",
              "text": "CMFlattenProcPtr"
            },
            {
              "kind": "text",
              "text": " = ("
            },
            {
              "identifier": "doc://com.apple.Swift/documentation/Swift/Int32",
              "kind": "typeIdentifier",
              "preciseIdentifier": "s:s5Int32V",
              "text": "Int32"
            },
            {
              "kind": "text",
              "text": ", "
            },
            {
              "identifier": "doc://com.apple.Swift/documentation/Swift/UnsafeMutablePointer",
              "kind": "typeIdentifier",
              "preciseIdentifier": "s:Sp",
              "text": "UnsafeMutablePointer"
            },
            {
              "kind": "text",
              "text": "<"
            },
            {
              "identifier": "doc://com.apple.Swift/documentation/Swift/Int",
              "kind": "typeIdentifier",
              "preciseIdentifier": "s:Si",
              "text": "Int"
            },
            {
              "kind": "text",
              "text": ">?"
            },
            {
              "kind": "text",
              "text": ", "
            },
            {
              "identifier": "doc://com.apple.Swift/documentation/Swift/UnsafeMutableRawPointer",
              "kind": "typeIdentifier",
              "preciseIdentifier": "s:Sv",
              "text": "UnsafeMutableRawPointer"
            },
            {
              "kind": "text",
              "text": "?"
            },
            {
              "kind": "text",
              "text": ", "
            },
            {
              "identifier": "doc://com.apple.Swift/documentation/Swift/UnsafeMutableRawPointer",
              "kind": "typeIdentifier",
              "preciseIdentifier": "s:Sv",
              "text": "UnsafeMutableRawPointer"
            },
            {
              "kind": "text",
              "text": "?"
            },
            {
              "kind": "text",
              "text": ") -> "
            },
            {
              "kind": "typeIdentifier",
              "preciseIdentifier": "c:@T@OSErr",
              "text": "OSErr"
            }
          ]
        }
      ],
      "kind": "declarations"
    },
    {
      "kind": "parameters",
      "languages": [
        "swift"
      ],
      "parameters": [
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The command with which the ",
                  "type": "text"
                },
                {
                  "code": "MyCMFlattenCallback",
                  "type": "codeVoice"
                },
                {
                  "text": " function is called. This command specifies the operation the function is to perform. ",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "command"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "A pointer to a size value. On input, the size in bytes of the data to transfer. On return, the size of the data actually transferred.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "size"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "A pointer to the buffer supplied by the ColorSync Manager to use for the data transfer. ",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "data"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "A pointer to a reference constant that holds the application data passed in from the functions ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804897-cmflattenprofile",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ", ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804901-ncmunflattenprofile",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ", ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805206-cmgetps2colorrenderingvmsize",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ", ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805196-cmgetps2colorrenderingintent",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ", or ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804897-cmflattenprofile",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ". Each time the CMM calls your ",
                  "type": "text"
                },
                {
                  "code": "MyCMFlattenCallback",
                  "type": "codeVoice"
                },
                {
                  "text": " function, it passes this data to the function.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            },
            {
              "inlineContent": [
                {
                  "text": "Starting in ColorSync version 2.5, the ColorSync Manager calls your function directly, without going through the preferred, or any, CMM.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "refCon"
        }
      ]
    },
    {
      "content": [
        {
          "anchor": "return_value",
          "level": 2,
          "text": "Return Value",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "A result code. See ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager#1670295",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        }
      ],
      "kind": "content"
    },
    {
      "content": [
        {
          "anchor": "discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "IThis callback can be used, for example, by PostScript functions to transfer data from a profile to text format usable by a PostScript driver. Starting in ColorSync version 2.5, the ColorSync Manager calls your data transfer function directly, without going through the preferred, or any, CMM. So any references to the CMM in the discussion that follows are applicable only to versions of ColorSync prior to version 2.5. Where the discussion does not involve CMMs, it is applicable to all versions of ColorSync.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "Your ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function is called to flatten and unflatten profiles or to transfer PostScript-related data from a profile to the PostScript format to send to an application or device driver. ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The ColorSync Manager and the CMM communicate with the ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function using the command parameter to identify the operation to perform. To read and write profile data, your function must support the following commands: ",
              "type": "text"
            },
            {
              "code": "cmOpenReadSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmOpenWriteSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmReadSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmWriteSpool",
              "type": "codeVoice"
            },
            {
              "text": ", and ",
              "type": "text"
            },
            {
              "code": "cmCloseSpool",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "You determine the behavior of your ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function. The following sections describe how your function might handle the flattening and unflattening processes.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "Flattening a Profile:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The ColorSync Manager calls the specified profile’s preferred CMM when an application calls the ",
              "type": "text"
            },
            {
              "code": "CMFlattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function to transfer profile data embedded in a graphics document. ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The ColorSync Manager determines if the CMM supports the ",
              "type": "text"
            },
            {
              "code": "CMFlattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function. If so, the ColorSync Manager dispatches the ",
              "type": "text"
            },
            {
              "code": "CMFlattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function to the CMM. If not, ColorSync calls the default CMM, dispatching the ",
              "type": "text"
            },
            {
              "code": "CMFlattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function to it.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The CMM communicates with the ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function using a command parameter to identify the operation to perform. The CMM calls your function as often as necessary, passing to it on each call any data transferred to the CMM from the ",
              "type": "text"
            },
            {
              "code": "CMFlattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function’s ",
              "type": "text"
            },
            {
              "code": "refCon",
              "type": "codeVoice"
            },
            {
              "text": " parameter. ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The ColorSync Manager calls your function with the following sequence of commands: ",
              "type": "text"
            },
            {
              "code": "cmOpenWriteSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmWriteSpool",
              "type": "codeVoice"
            },
            {
              "text": ", and ",
              "type": "text"
            },
            {
              "code": "cmCloseSpool",
              "type": "codeVoice"
            },
            {
              "text": ". Here is how you should handle these commands:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " When the CMM calls your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmOpenWriteSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command, you should perform any initialization required to write profile data you receive from the CMM to a buffer or file.  ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " The CMM will call your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmWriteSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command as many times as necessary to transfer all the profile data to you. Each time you are called, you should receive the data and write it to your buffer or file, returning in the ",
                      "type": "text"
                    },
                    {
                      "code": "size",
                      "type": "codeVoice"
                    },
                    {
                      "text": " parameter the number of bytes of data you actually accepted. ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " When the CMM calls your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmCloseSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command, you should perform any required cleanup processes.  ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "unorderedList"
        },
        {
          "inlineContent": [
            {
              "text": "As part of this process, your function can embed the profile data in a graphics document, for example, a PICT file or a TIFF file. For example, your ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function can call the QuickDraw ",
              "type": "text"
            },
            {
              "code": "PicComment",
              "type": "codeVoice"
            },
            {
              "text": " function to embed the flattened profile in a picture.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "Unflattening a Profile:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "When an application calls the ",
              "type": "text"
            },
            {
              "code": "CMUnflattenProfile",
              "type": "codeVoice"
            },
            {
              "text": " function to transfer a profile that is embedded in a graphics document to an independent disk file, the ColorSync Manager calls your ",
              "type": "text"
            },
            {
              "code": "MyCMFlattenCallback",
              "type": "codeVoice"
            },
            {
              "text": " function with the following sequence of commands: ",
              "type": "text"
            },
            {
              "code": "cmOpenReadSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmReadSpool",
              "type": "codeVoice"
            },
            {
              "text": ", ",
              "type": "text"
            },
            {
              "code": "cmCloseSpool",
              "type": "codeVoice"
            },
            {
              "text": ". Here is how you should handle these commands:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " When the ColorSync Manager calls your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmOpenReadSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command, you should perform any initialization required to read from the embedded profile format. ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " The ColorSync Manager calls your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmReadSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command as many times as necessary, directing your function to extract the profile data from the embedded format in the image file and return it to the ColorSync Manager in the ",
                      "type": "text"
                    },
                    {
                      "code": "data",
                      "type": "codeVoice"
                    },
                    {
                      "text": " buffer. For each call, the ColorSync Manager specifies in the ",
                      "type": "text"
                    },
                    {
                      "code": "size",
                      "type": "codeVoice"
                    },
                    {
                      "text": " parameter the number of bytes of data you should return. Each time your function is called it should read and return the requested data; it should also specify in the ",
                      "type": "text"
                    },
                    {
                      "code": "size",
                      "type": "codeVoice"
                    },
                    {
                      "text": " parameter the actual number of bytes of data it returns. ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": " When the ColorSync Manager calls your function with the ",
                      "type": "text"
                    },
                    {
                      "code": "cmCloseSpool",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command, you should perform any required cleanup processes. ",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "unorderedList"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "doc://com.apple.Swift/documentation/Swift/Int": {
      "identifier": "doc://com.apple.Swift/documentation/Swift/Int",
      "kind": "symbol",
      "role": "symbol",
      "title": "Int",
      "type": "topic",
      "url": "/documentation/swift/int"
    },
    "doc://com.apple.Swift/documentation/Swift/Int32": {
      "identifier": "doc://com.apple.Swift/documentation/Swift/Int32",
      "kind": "symbol",
      "role": "symbol",
      "title": "Int32",
      "type": "topic",
      "url": "/documentation/swift/int32"
    },
    "doc://com.apple.Swift/documentation/Swift/UnsafeMutablePointer": {
      "identifier": "doc://com.apple.Swift/documentation/Swift/UnsafeMutablePointer",
      "kind": "symbol",
      "role": "symbol",
      "title": "UnsafeMutablePointer",
      "type": "topic",
      "url": "/documentation/swift/unsafemutablepointer"
    },
    "doc://com.apple.Swift/documentation/Swift/UnsafeMutableRawPointer": {
      "identifier": "doc://com.apple.Swift/documentation/Swift/UnsafeMutableRawPointer",
      "kind": "symbol",
      "role": "symbol",
      "title": "UnsafeMutableRawPointer",
      "type": "topic",
      "url": "/documentation/swift/unsafemutablerawpointer"
    },
    "doc://com.apple.documentation/documentation/applicationservices": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices",
      "kind": "symbol",
      "role": "collection",
      "title": "Application Services",
      "type": "topic",
      "url": "/documentation/applicationservices"
    },
    "doc://com.apple.documentation/documentation/applicationservices/cmflattenprocptr": {
      "abstract": [
        {
          "text": "Defines a pointer to a data transfer callback function that transfers profile data from the format for embedded profiles to disk file format or vice versa.",
          "type": "text"
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "typealias "
        },
        {
          "kind": "identifier",
          "text": "CMFlattenProcPtr"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/cmflattenprocptr",
      "kind": "symbol",
      "role": "symbol",
      "title": "CMFlattenProcPtr",
      "type": "topic",
      "url": "/documentation/applicationservices/cmflattenprocptr"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager",
      "kind": "article",
      "role": "collectionGroup",
      "title": "ColorSync Manager",
      "type": "topic",
      "url": "/documentation/applicationservices/colorsync_manager"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager#1670295": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager#1670295",
      "kind": "article",
      "role": "task",
      "title": "Result Codes",
      "type": "section",
      "url": "/documentation/applicationservices/colorsync_manager#1670295"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804897-cmflattenprofile": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804897-cmflattenprofile",
      "kind": "symbol",
      "role": "pseudoSymbol",
      "title": "CMFlattenProfile",
      "type": "topic",
      "url": "/documentation/applicationservices/colorsync_manager/1804897-cmflattenprofile"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804901-ncmunflattenprofile": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1804901-ncmunflattenprofile",
      "kind": "symbol",
      "role": "pseudoSymbol",
      "title": "NCMUnflattenProfile",
      "type": "topic",
      "url": "/documentation/applicationservices/colorsync_manager/1804901-ncmunflattenprofile"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805196-cmgetps2colorrenderingintent": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805196-cmgetps2colorrenderingintent",
      "kind": "symbol",
      "role": "pseudoSymbol",
      "title": "CMGetPS2ColorRenderingIntent",
      "type": "topic",
      "url": "/documentation/applicationservices/colorsync_manager/1805196-cmgetps2colorrenderingintent"
    },
    "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805206-cmgetps2colorrenderingvmsize": {
      "identifier": "doc://com.apple.documentation/documentation/applicationservices/colorsync_manager/1805206-cmgetps2colorrenderingvmsize",
      "kind": "symbol",
      "role": "pseudoSymbol",
      "title": "CMGetPS2ColorRenderingVMSize",
      "type": "topic",
      "url": "/documentation/applicationservices/colorsync_manager/1805206-cmgetps2colorrenderingvmsize"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    }
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "paths": [
        "documentation/applicationservices/cmflattenprocptr"
      ],
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ]
    },
    {
      "paths": [
        "documentation/applicationservices/cmflattenprocptr"
      ],
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ]
    }
  ]
}
