{
  "abstract": [
    {
      "text": "The request object for sending the new token details.",
      "type": "text"
    }
  ],
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.devicemanagement/documentation/DeviceManagement"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "data",
    "url": "doc://com.apple.devicemanagement/documentation/DeviceManagement/TokenUpdateRequest"
  },
  "kind": "symbol",
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "externalID": "mdm-commands:TokenUpdateRequest",
    "fragments": [
      {
        "kind": "text",
        "text": "object "
      },
      {
        "kind": "identifier",
        "text": "TokenUpdateRequest"
      }
    ],
    "modules": [
      {
        "name": "Device Management"
      }
    ],
    "navigatorTitle": [
      {
        "kind": "identifier",
        "text": "TokenUpdateRequest"
      }
    ],
    "platforms": [
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "4.0",
        "name": "iOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "4.0",
        "name": "iPadOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "10.7",
        "name": "macOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "10.2",
        "name": "tvOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "1.1",
        "name": "visionOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "introducedAt": "10.0",
        "name": "watchOS",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "name": "Device Assignment Services",
        "unavailable": false
      },
      {
        "beta": false,
        "deprecated": false,
        "name": "VPP License Management",
        "unavailable": false
      }
    ],
    "role": "symbol",
    "roleHeading": "Device Management Command",
    "symbolKind": "dictionary",
    "title": "TokenUpdateRequest"
  },
  "primaryContentSections": [
    {
      "declarations": [
        {
          "languages": [
            "data"
          ],
          "platforms": [
            "Unsupported OS: iOS",
            "Unsupported OS: macOS",
            "Unsupported OS: tvOS",
            "Unsupported OS: visionOS",
            "Unsupported OS: watchOS"
          ],
          "tokens": [
            {
              "kind": "text",
              "text": "object "
            },
            {
              "kind": "identifier",
              "text": "TokenUpdateRequest"
            }
          ]
        }
      ],
      "kind": "declarations"
    },
    {
      "items": [
        {
          "attributes": [
            {
              "kind": "default",
              "value": "false"
            }
          ],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "If ",
                  "type": "text"
                },
                {
                  "code": "true",
                  "type": "codeVoice"
                },
                {
                  "text": " from the device channel, the device is awaiting a ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Device-Configured-Command",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": " MDM command before proceeding through Setup Assistant.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            },
            {
              "inlineContent": [
                {
                  "text": "If ",
                  "type": "text"
                },
                {
                  "code": "true",
                  "type": "codeVoice"
                },
                {
                  "text": " from the user channel (Shared iPad only), the device is awaiting a ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/UserConfiguredCommand",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": " MDM command before proceeding through Setup Assistant.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "AwaitingConfiguration",
          "required": false,
          "type": [
            {
              "kind": "text",
              "text": "boolean"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The per-enrollment identifier for the device. Available in macOS 10.15 and iOS 13.0 and later.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "EnrollmentID",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The per-enrollment identifier for the user. Available in macOS 10.15 and iOS 13.0 and later.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "EnrollmentUserID",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [
            {
              "kind": "allowedValues",
              "values": [
                "TokenUpdate"
              ]
            }
          ],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The message type, which must have a value of ",
                  "type": "text"
                },
                {
                  "code": "TokenUpdate",
                  "type": "codeVoice"
                },
                {
                  "text": ".",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "MessageType",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "If true, the device is not on console.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "NotOnConsole",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "boolean"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The magic string that has to be included in the push notification message.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "PushMagic",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The Push token for the device.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "Token",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "data"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The topic the device subscribes to.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "Topic",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The deviceâ€™s UDID.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "UDID",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The data that can be used to unlock the device. If provided, the server should remember this data and send it with when trying to ",
                  "type": "text"
                },
                {
                  "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Clear-Passcode-Command",
                  "isActive": true,
                  "type": "reference"
                },
                {
                  "text": ".",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "UnlockToken",
          "required": false,
          "type": [
            {
              "kind": "text",
              "text": "data"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "On Shared iPad: This is the Managed Apple ID of the user on Shared iPad. It indicates that the token is for the user channel.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            },
            {
              "inlineContent": [
                {
                  "text": "On macOS, this is the short name of the user.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "UserShortName",
          "required": false,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "On macOS: This is the ID of the user.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            },
            {
              "inlineContent": [
                {
                  "text": "On Shared iPad: This is always ",
                  "type": "text"
                },
                {
                  "code": "FFFFFFFF-FFFF-FFFF-FFFF-FFFFFFFFFFFF",
                  "type": "codeVoice"
                },
                {
                  "text": " to indicate that no authentication will occur.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "UserID",
          "required": false,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        },
        {
          "attributes": [],
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The full name of the user.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "introducedVersion": "4.0.0",
          "name": "UserLongName",
          "required": true,
          "type": [
            {
              "kind": "text",
              "text": "string"
            }
          ]
        }
      ],
      "kind": "properties",
      "title": "Properties"
    },
    {
      "kind": "mentions",
      "mentions": [
        "doc://com.apple.devicemanagement/documentation/DeviceManagement/managing-passcodes"
      ]
    },
    {
      "content": [
        {
          "anchor": "Discussion",
          "level": 2,
          "text": "Discussion",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "The device sends an initial token update message to the server when it has installed the MDM payload. The server should send push messages to the device only after receiving the first token update message. If the device reports that it is ",
              "type": "text"
            },
            {
              "code": "AwaitingConfiguration",
              "type": "codeVoice"
            },
            {
              "text": ", the MDM server is expected to send a ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Device-Configured-Command",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " MDM command before the device can allow the user to proceed in Setup Assistant. This gives the MDM server the opportunity to do some setup via MDM commands.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "In addition to sending the initial ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " message, the iOS device may now send additional ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " messages to the check-in server at any time while it has a valid MDM enrollment.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The use of ",
              "type": "text"
            },
            {
              "code": "PushMagic",
              "type": "codeVoice"
            },
            {
              "text": " constrains the device to a unique MDM relationship. When a user removes the MDM profile, the device should no longer listen to the former relationship, even if the user reestablishes a management relationship with the same server topic. Note that only the push topic is the same in this case; the serverÊ¼s address could have changed. This also helps when a user restores a device from backup that contains an older relationship. The use of ",
              "type": "text"
            },
            {
              "code": "PushMagic",
              "type": "codeVoice"
            },
            {
              "text": " also ensures that the server that receives the ",
              "type": "text"
            },
            {
              "code": "CheckIn",
              "type": "codeVoice"
            },
            {
              "text": " message is owned by the same enterprise as the computer sending push notifications. This is important because there is no way of knowing if the push topic belongs to the owner of the checkin server. It is conceivable that Apple could revoke a push token for one party, only to have that party re-enroll people piggybacking on some other topic thatÊ¼s actively pushing. The fact that all MDM push topics reside in the namespace com.apple.mgmt.* helps prevent this.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The ",
              "type": "text"
            },
            {
              "code": "PushMagic",
              "type": "codeVoice"
            },
            {
              "text": " or ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": " fields of subsequent ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " messages may be identical to those in previous messages or may be different (and may differ in size from previous values). If different, the server should update its record for the device to the new value provided by the message. Failure to do so results in the server being unable to send push notifications or perform passcode resets.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "While the ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": " message can be sent multiple times by the device, it is possible it may only be sent once if ",
              "type": "text"
            },
            {
              "code": "PushMagic",
              "type": "codeVoice"
            },
            {
              "text": " or ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": " values change. Implementations should not rely on repeated messages to update lost server-side data or to recover from a failure to process a previous ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": " message.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "While the ",
              "type": "text"
            },
            {
              "code": "Token Update",
              "type": "codeVoice"
            },
            {
              "text": " message can be sent multiple times by the device, it is possible that it may only be sent once if the values contained within the message never change. Implementations should not rely on repeated messages to update lost server-side data or to recover from a failure to process a previous ",
              "type": "text"
            },
            {
              "code": "Token Update",
              "type": "codeVoice"
            },
            {
              "text": " message. Also note that the ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": " is optional. The absence of an ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": " in a ",
              "type": "text"
            },
            {
              "code": "Token Update",
              "type": "codeVoice"
            },
            {
              "text": " message should not be treated as an invalidation of a previously received ",
              "type": "text"
            },
            {
              "code": "UnlockToken",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "",
                  "type": "text"
                },
                {
                  "text": " ",
                  "type": "text"
                },
                {
                  "text": "The topic string for the MDM check-in protocol must start with ",
                  "type": "text"
                },
                {
                  "code": "com.apple.mgmt.*",
                  "type": "codeVoice"
                },
                {
                  "text": " where ",
                  "type": "text"
                },
                {
                  "code": "*",
                  "type": "codeVoice"
                },
                {
                  "text": " is a unique suffix.",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "Note",
          "style": "note",
          "type": "aside"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "doc://com.apple.devicemanagement/documentation/DeviceManagement": {
      "abstract": [
        {
          "text": "Manage your organizationâ€™s devices remotely.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement",
      "kind": "symbol",
      "role": "collection",
      "title": "Device Management",
      "type": "topic",
      "url": "/documentation/devicemanagement"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/Clear-Passcode-Command": {
      "abstract": [
        {
          "text": "Remove the passcode from a device.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Clear-Passcode-Command",
      "kind": "symbol",
      "navigatorTitle": [
        {
          "kind": "identifier",
          "text": "Clear Passcode Command"
        }
      ],
      "role": "symbol",
      "title": "Clear the Passcode",
      "type": "topic",
      "url": "/documentation/devicemanagement/clear-passcode-command"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/Device-Configured-Command": {
      "abstract": [
        {
          "text": "Inform the device that it can allow the user to continue in Setup Assistant.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Device-Configured-Command",
      "kind": "symbol",
      "navigatorTitle": [
        {
          "kind": "identifier",
          "text": "Device Configured Command"
        }
      ],
      "role": "symbol",
      "title": "Release Device from Await Configuration",
      "type": "topic",
      "url": "/documentation/devicemanagement/device-configured-command"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update": {
      "abstract": [
        {
          "text": "Updates the token for a device on the server.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/Token-Update",
      "kind": "symbol",
      "navigatorTitle": [
        {
          "kind": "identifier",
          "text": "Token Update"
        }
      ],
      "role": "symbol",
      "title": "Token Update",
      "type": "topic",
      "url": "/documentation/devicemanagement/token-update"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/TokenUpdateRequest": {
      "abstract": [
        {
          "text": "The request object for sending the new token details.",
          "type": "text"
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "object "
        },
        {
          "kind": "identifier",
          "text": "TokenUpdateRequest"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/TokenUpdateRequest",
      "kind": "symbol",
      "navigatorTitle": [
        {
          "kind": "identifier",
          "text": "TokenUpdateRequest"
        }
      ],
      "role": "symbol",
      "title": "TokenUpdateRequest",
      "type": "topic",
      "url": "/documentation/devicemanagement/tokenupdaterequest"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/UserConfiguredCommand": {
      "abstract": [
        {
          "text": "The command to inform a Shared iPad that the system has configured the user and can allow the user to continue in Setup Assistant.",
          "type": "text"
        }
      ],
      "fragments": [
        {
          "kind": "text",
          "text": "object "
        },
        {
          "kind": "identifier",
          "text": "UserConfiguredCommand"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/UserConfiguredCommand",
      "kind": "symbol",
      "navigatorTitle": [
        {
          "kind": "identifier",
          "text": "UserConfiguredCommand"
        }
      ],
      "role": "symbol",
      "title": "UserConfiguredCommand",
      "type": "topic",
      "url": "/documentation/devicemanagement/userconfiguredcommand"
    },
    "doc://com.apple.devicemanagement/documentation/DeviceManagement/managing-passcodes": {
      "abstract": [
        {
          "text": "Ensure data security by managing device passcodes and compliance with policies.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.devicemanagement/documentation/DeviceManagement/managing-passcodes",
      "kind": "article",
      "role": "article",
      "title": "Managing Passcodes",
      "type": "topic",
      "url": "/documentation/devicemanagement/managing-passcodes"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "abstract": [
        {
          "text": "",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "role": "overview",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    }
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "variants": [
    {
      "paths": [
        "/documentation/devicemanagement/tokenupdaterequest"
      ],
      "traits": [
        {
          "interfaceLanguage": "data"
        }
      ]
    }
  ]
}
