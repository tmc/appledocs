{
  "abstract": [
    {
      "text": "Optimize a movie for delivery over the web.",
      "type": "text"
    }
  ],
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies",
        "doc://com.apple.qtff/documentation/quicktime-file-format",
        "doc://com.apple.qtff/documentation/QuickTime-File-Format/Deprecated_atoms",
        "doc://com.apple.qtff/documentation/QuickTime-File-Format/QuickTime_VR_file_format",
        "doc://com.apple.qtff/documentation/QuickTime-File-Format/Optimizing_QuickTime_VR_movies_for_web_playback"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "swift",
    "url": "doc://com.apple.qtff/documentation/QuickTime-File-Format/The_QTVR_flattener"
  },
  "kind": "article",
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "modules": [
      {
        "name": "QuickTime File Format"
      }
    ],
    "role": "article",
    "roleHeading": "Article",
    "title": "The QTVR flattener"
  },
  "primaryContentSections": [
    {
      "content": [
        {
          "anchor": "Overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "The QTVR Flattener is a movie export component that converts an existing QuickTime VR single node movie into a new movie that is optimized for the Web. Not only does the flattener reorder the media samples, but for panoramas it also creates a small preview of the panorama. When viewed on the Web, this preview appears after 5% to 10% of the movie data has been downloaded, allowing users to see a lower-resolution version of the panorama.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "Using the QTVR flattener from your application is quite easy. After you have created the QuickTime VR movie, you simply open the QTVR Flattener component and call the ",
              "type": "text"
            },
            {
              "code": "MovieExportToFile",
              "type": "codeVoice"
            },
            {
              "text": " routine as shown in the following listing.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "ComponentDescription desc;",
            "Component flattener;",
            "ComponentInstance qtvrExport = nil;",
            "desc.componentType = MovieExportType;",
            "desc.componentSubType = MovieFileType;",
            "desc.componentManufacturer = QTVRFlattenerType;",
            "flattener = FindNextComponent(nil, &desc);",
            "if (flattener) qtvrExport = OpenComponent (flattener);",
            "if (qtvrExport)",
            "    MovieExportToFile (qtvrExport, &myFileSpec, myQTVRMovie,  nil, 0, 0);"
          ],
          "syntax": "c",
          "type": "codeListing"
        },
        {
          "inlineContent": [
            {
              "text": "The code fragment shown in the preceeding listing creates a flattened movie file specified by the ",
              "type": "text"
            },
            {
              "code": "myFileSpec",
              "type": "codeVoice"
            },
            {
              "text": " parameter. If your QuickTime VR movie is a panorama, the flattened movie file includes a quarter size, blurred JPEG, compressed preview of the panorama image.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "The constants ",
                  "type": "text"
                },
                {
                  "code": "MovieExportType",
                  "type": "codeVoice"
                },
                {
                  "text": " and ",
                  "type": "text"
                },
                {
                  "code": "MovieFileType",
                  "type": "codeVoice"
                },
                {
                  "text": " used in the preceeding listing are defined in header files QuickTimeComponents.h and Movies.h respectively and are defined as ",
                  "type": "text"
                },
                {
                  "code": "'spit'",
                  "type": "codeVoice"
                },
                {
                  "text": " and ",
                  "type": "text"
                },
                {
                  "code": "'MooV'",
                  "type": "codeVoice"
                },
                {
                  "text": ".",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "name": "Note",
          "style": "note",
          "type": "aside"
        },
        {
          "inlineContent": [
            {
              "text": "You can present users with the QTVR Flattener’s own dialog box to allow them to choose options such as how to compress the preview image or to select a separate preview image file. Use the following code to show the dialog box:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "err = MovieExportDoUserDialog (qtvrExport, myQTVRMovie,  nil, 0, 0,  &cancel);"
          ],
          "syntax": "c",
          "type": "codeListing"
        },
        {
          "inlineContent": [
            {
              "text": "If the user cancels the dialog box, then the Boolean cancel is set to ",
              "type": "text"
            },
            {
              "code": "true",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "If you do not want to present the user with the flattener’s dialog box, you can communicate directly with the component by using the ",
              "type": "text"
            },
            {
              "code": "MovieExportSetSettingsFromAtomContainer",
              "type": "codeVoice"
            },
            {
              "text": " routine as described in the following paragraphs.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "If you want to specify a preview image other than the default, you need to create a special atom container and then call ",
              "type": "text"
            },
            {
              "code": "MovieExportSetSettingsFromAtomContainer",
              "type": "codeVoice"
            },
            {
              "text": " before calling ",
              "type": "text"
            },
            {
              "code": "MovieExportToFile",
              "type": "codeVoice"
            },
            {
              "text": ". You can specify how to compress the image, what resolution to use, and you can even specify your own preview image file to be used. The atom container you pass in can have various atoms that specify certain export options. These atoms must all be children of a flattener settings parent atom.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The preview resolution atom is a 16-bit value that allows you to specify the resolution of the preview image. This value, which defaults to ",
              "type": "text"
            },
            {
              "code": "kQTVRQuarterRes",
              "type": "codeVoice"
            },
            {
              "text": ", indicates how much to reduce the preview image.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The blur preview atom is a Boolean value that indicates whether to blur the image before compressing. Blurring usually results in a much more highly compressed image. The default value is ",
              "type": "text"
            },
            {
              "code": "true",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The create preview atom is a Boolean value that indicates whether a preview image should be created. The default value is ",
              "type": "text"
            },
            {
              "code": "true",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "The import preview atom is a Boolean value that is used to indicate that the preview image should be imported from an external file rather than generated from the image in the panorama file itself. This allows you to have any image you want as the preview for the panorama. You can specify which file to use by also including the import specification atom, which is an ",
              "type": "text"
            },
            {
              "code": "FSSpec",
              "type": "codeVoice"
            },
            {
              "text": " data structure that identifies the image file. If you do not include this atom, then the flattener presents the user with a dialog box asking the user to select a file. The default for import preview is ",
              "type": "text"
            },
            {
              "code": "false",
              "type": "codeVoice"
            },
            {
              "text": ". If an import file is used, the image is used at its natural size and the resolution setting is ignored.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/technologies": {
      "abstract": [
        {
          "text": "",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "role": "overview",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    },
    "doc://com.apple.qtff/documentation/QuickTime-File-Format/Deprecated_atoms": {
      "abstract": [
        {
          "text": "Review unsupported atoms.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.qtff/documentation/QuickTime-File-Format/Deprecated_atoms",
      "kind": "article",
      "role": "collectionGroup",
      "title": "Deprecated atoms",
      "type": "topic",
      "url": "/documentation/quicktime-file-format/deprecated_atoms"
    },
    "doc://com.apple.qtff/documentation/QuickTime-File-Format/Optimizing_QuickTime_VR_movies_for_web_playback": {
      "abstract": [
        {
          "text": "Prevent having to download an entire movie before starting playback.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.qtff/documentation/QuickTime-File-Format/Optimizing_QuickTime_VR_movies_for_web_playback",
      "kind": "article",
      "role": "collectionGroup",
      "title": "Optimizing QuickTime VR movies for web playback",
      "type": "topic",
      "url": "/documentation/quicktime-file-format/optimizing_quicktime_vr_movies_for_web_playback"
    },
    "doc://com.apple.qtff/documentation/QuickTime-File-Format/QuickTime_VR_file_format": {
      "abstract": [
        {
          "text": "A file format used to store a QuickTime VR movie on disk.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.qtff/documentation/QuickTime-File-Format/QuickTime_VR_file_format",
      "kind": "article",
      "role": "collectionGroup",
      "title": "QuickTime VR file format",
      "type": "topic",
      "url": "/documentation/quicktime-file-format/quicktime_vr_file_format"
    },
    "doc://com.apple.qtff/documentation/QuickTime-File-Format/Sample_atom_container_for_the_QTVR_flattener": {
      "abstract": [
        {
          "text": "Specify an import preview file for the flattener with atoms.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.qtff/documentation/QuickTime-File-Format/Sample_atom_container_for_the_QTVR_flattener",
      "kind": "article",
      "role": "article",
      "title": "Sample atom container for the QTVR flattener",
      "type": "topic",
      "url": "/documentation/quicktime-file-format/sample_atom_container_for_the_qtvr_flattener"
    },
    "doc://com.apple.qtff/documentation/quicktime-file-format": {
      "abstract": [
        {
          "text": "An object-oriented file format for the storage and exchange of digital media between devices, applications, and operating systems.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.qtff/documentation/quicktime-file-format",
      "kind": "symbol",
      "role": "collection",
      "title": "QuickTime File Format",
      "type": "topic",
      "url": "/documentation/quicktime-file-format"
    }
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "seeAlsoSections": [
    {
      "anchor": "Optimizations",
      "generated": true,
      "identifiers": [
        "doc://com.apple.qtff/documentation/QuickTime-File-Format/Sample_atom_container_for_the_QTVR_flattener"
      ],
      "title": "Optimizations"
    }
  ],
  "variants": [
    {
      "paths": [
        "/documentation/quicktime-file-format/the_qtvr_flattener"
      ],
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ]
    }
  ]
}
