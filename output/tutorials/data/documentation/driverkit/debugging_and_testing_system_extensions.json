{
  "abstract": [
    {
      "text": "Debug your system extensions by temporarily disabling the security checks that macOS performs during the installation process.",
      "type": "text"
    }
  ],
  "documentVersion": 0,
  "hierarchy": {
    "paths": [
      [
        "doc://com.apple.documentation/documentation/technologies"
      ]
    ]
  },
  "identifier": {
    "interfaceLanguage": "swift",
    "url": "doc://com.apple.documentation/documentation/driverkit/debugging_and_testing_system_extensions"
  },
  "kind": "article",
  "legacy_identifier": 3557205,
  "legalNotices": {
    "copyright": "Copyright &copy; 2025 Apple Inc. All rights reserved.",
    "privacyPolicy": "https://www.apple.com/privacy/privacy-policy",
    "termsOfUse": "https://www.apple.com/legal/internet-services/terms/site.html"
  },
  "metadata": {
    "modules": [
      {
        "name": "DriverKit"
      }
    ],
    "role": "article",
    "roleHeading": "Article",
    "title": "Debugging and testing system extensions"
  },
  "primaryContentSections": [
    {
      "content": [
        {
          "anchor": "overview",
          "level": 2,
          "text": "Overview",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "When you activate a system extension from your app, the system requires your extension to have the proper entitlements and code signature. It must also meet all other criteria for running on the user’s system. If the extension doesn’t meet all of the requirements, the activation request fails with an error. During the development of a system extension, you can disable some validation checks to simplify writing and testing your code. ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "content": [
            {
              "inlineContent": [
                {
                  "text": "Always remember to reenable all validation checks and perform additional testing before shipping your system extension to users. Disabling validation checks is only appropriate during the development process on your local system. ",
                  "type": "text"
                }
              ],
              "type": "paragraph"
            }
          ],
          "style": "important",
          "type": "aside"
        },
        {
          "anchor": "3557204",
          "level": 3,
          "text": "Enable activation from any directory",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "You must place all system extensions in the ",
              "type": "text"
            },
            {
              "code": "Contents/Library/SystemExtensions",
              "type": "codeVoice"
            },
            {
              "text": " directory of your app bundle, and the app itself must be installed in one of the system’s ",
              "type": "text"
            },
            {
              "code": "Applications",
              "type": "codeVoice"
            },
            {
              "text": " directories. To allow development of your app outside of these directories, use the ",
              "type": "text"
            },
            {
              "code": "systemextensionsctl",
              "type": "codeVoice"
            },
            {
              "text": " command-line tool to enable developer mode. When in developer mode, the system doesn't check the location of your system extension prior to loading it, so you can load it from anywhere in the file system. To enable developer mode, open a Terminal window and execute the following command:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "code": "% systemextensionsctl developer on",
              "type": "codeVoice"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "To turn developer mode off, open Terminal and run the same tool with ",
              "type": "text"
            },
            {
              "code": "developer off",
              "type": "codeVoice"
            },
            {
              "text": " as the parameter.",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "3557201",
          "level": 3,
          "text": "Disable code-signing and notarization checks",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "System Integrity Protection (SIP) in macOS prevents unauthorized code from running on your system. Xcode doesn’t notarize apps or system extensions during the normal development cycle, so disabling SIP bypasses the notarization checks that the system normally performs, and allows you to debug your code more quickly. ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "inlineContent": [
            {
              "text": "For information on how to disable SIP, see ",
              "type": "text"
            },
            {
              "identifier": "doc://com.apple.security/documentation/Security/disabling-and-enabling-system-integrity-protection",
              "isActive": true,
              "type": "reference"
            },
            {
              "text": ". ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "3557202",
          "level": 3,
          "text": "Attach the debugger to your system extension",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Because the system loads system extensions dynamically, attach the debugger to your system extension’s process after the system launches it. The ",
              "type": "text"
            },
            {
              "code": "lldb",
              "type": "codeVoice"
            },
            {
              "text": " command-line tool provides a way to attach to any process and examine its state. To use this tool for your system extension, do the following:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "After your system extension launches, run the ",
                      "type": "text"
                    },
                    {
                      "code": "ps",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command-line tool and note your extension’s process ID.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Run ",
                      "type": "text"
                    },
                    {
                      "code": "lldb",
                      "type": "codeVoice"
                    },
                    {
                      "text": " from Terminal as the superuser.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Attach to the process using the ",
                      "type": "text"
                    },
                    {
                      "code": "process attach --pid",
                      "type": "codeVoice"
                    },
                    {
                      "text": " command in ",
                      "type": "text"
                    },
                    {
                      "code": "lldb",
                      "type": "codeVoice"
                    },
                    {
                      "text": ".",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "orderedList"
        },
        {
          "inlineContent": [
            {
              "text": "After you attach to your system extension’s process, you can use ",
              "type": "text"
            },
            {
              "code": "lldb",
              "type": "codeVoice"
            },
            {
              "text": " to examine its threads and other state information. To view a list of commands available from the ",
              "type": "text"
            },
            {
              "code": "lldb",
              "type": "codeVoice"
            },
            {
              "text": " command-line tool, run the tool in Terminal and type ",
              "type": "text"
            },
            {
              "code": "help",
              "type": "codeVoice"
            },
            {
              "text": ".",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "anchor": "3626024",
          "level": 3,
          "text": "Test your driver extensions on arm64e",
          "type": "heading"
        },
        {
          "inlineContent": [
            {
              "text": "Driver extensions (dexts) often coordinate with kernel extensions (kexts) to perform certain tasks. On Apple silicon, kexts use the ",
              "type": "text"
            },
            {
              "code": "arm64e",
              "type": "codeVoice"
            },
            {
              "text": " architecture, which includes support for pointer authentication codes (PACs). During your testing cycle, try to build your dext for the ",
              "type": "text"
            },
            {
              "code": "arm64e",
              "type": "codeVoice"
            },
            {
              "text": " architecture and address any issues that arise. To test your dext, do the following:",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "items": [
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Reboot your Mac with Apple silicon into Recovery mode.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Set the security level to Medium.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Disable System Integrity Protection, as descrbed in ",
                      "type": "text"
                    },
                    {
                      "identifier": "doc://com.apple.security/documentation/Security/disabling-and-enabling-system-integrity-protection",
                      "isActive": true,
                      "type": "reference"
                    },
                    {
                      "text": ".",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Reboot back to macOS.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            },
            {
              "content": [
                {
                  "inlineContent": [
                    {
                      "text": "Add the ",
                      "type": "text"
                    },
                    {
                      "code": "-arm64e_preview_abi",
                      "type": "codeVoice"
                    },
                    {
                      "text": " boot arg to your system.",
                      "type": "text"
                    }
                  ],
                  "type": "paragraph"
                }
              ]
            }
          ],
          "type": "orderedList"
        },
        {
          "inlineContent": [
            {
              "text": "The following example shows you how to use the ",
              "type": "text"
            },
            {
              "code": "nvram",
              "type": "codeVoice"
            },
            {
              "text": " command-line tool to add the ",
              "type": "text"
            },
            {
              "code": "-arm64e_preview_abi",
              "type": "codeVoice"
            },
            {
              "text": " boot arg:  ",
              "type": "text"
            }
          ],
          "type": "paragraph"
        },
        {
          "code": [
            "sudo nvram boot-args=-arm64e_preview_abi"
          ],
          "metadata": {
            "anchor": "3626023",
            "title": "Listing 1"
          },
          "syntax": "other",
          "type": "codeListing"
        },
        {
          "inlineContent": [],
          "type": "paragraph"
        }
      ],
      "kind": "content"
    }
  ],
  "references": {
    "doc://com.apple.documentation/documentation/driverkit/creating_a_driver_using_the_driverkit_sdk": {
      "abstract": [
        {
          "text": "Create a driver that supports proprietary features of your company’s hardware devices. ",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/driverkit/creating_a_driver_using_the_driverkit_sdk",
      "kind": "article",
      "role": "article",
      "title": "Creating a Driver Using the DriverKit SDK",
      "type": "topic",
      "url": "/documentation/driverkit/creating_a_driver_using_the_driverkit_sdk"
    },
    "doc://com.apple.documentation/documentation/driverkit/debugging_and_testing_system_extensions": {
      "abstract": [
        {
          "text": "Debug your system extensions by temporarily disabling the security checks that macOS performs during the installation process.",
          "type": "text"
        }
      ],
      "identifier": "doc://com.apple.documentation/documentation/driverkit/debugging_and_testing_system_extensions",
      "kind": "article",
      "role": "article",
      "title": "Debugging and testing system extensions",
      "type": "topic",
      "url": "/documentation/driverkit/debugging_and_testing_system_extensions"
    },
    "doc://com.apple.documentation/documentation/driverkit/debugging_and_testing_system_extensions#3626023": {
      "identifier": "doc://com.apple.documentation/documentation/driverkit/debugging_and_testing_system_extensions#3626023",
      "kind": "article",
      "role": "codeListing",
      "title": "Listing 1",
      "type": "section",
      "url": "/documentation/driverkit/debugging_and_testing_system_extensions#3626023"
    },
    "doc://com.apple.documentation/documentation/technologies": {
      "identifier": "doc://com.apple.documentation/documentation/technologies",
      "kind": "technologies",
      "title": "Technologies",
      "type": "topic",
      "url": "/documentation/technologies"
    },
    "doc://com.apple.security/documentation/Security/disabling-and-enabling-system-integrity-protection": {
      "identifier": "doc://com.apple.security/documentation/Security/disabling-and-enabling-system-integrity-protection",
      "kind": "article",
      "role": "article",
      "title": "Disabling and Enabling System Integrity Protection",
      "type": "topic",
      "url": "/documentation/security/disabling-and-enabling-system-integrity-protection"
    }
  },
  "schemaVersion": {
    "major": 0,
    "minor": 3,
    "patch": 0
  },
  "sections": [],
  "seeAlsoSections": [
    {
      "generated": true,
      "identifiers": [
        "doc://com.apple.documentation/documentation/driverkit/creating_a_driver_using_the_driverkit_sdk"
      ],
      "title": "Services"
    }
  ],
  "variants": [
    {
      "paths": [
        "documentation/driverkit/debugging_and_testing_system_extensions"
      ],
      "traits": [
        {
          "interfaceLanguage": "occ"
        }
      ]
    },
    {
      "paths": [
        "documentation/driverkit/debugging_and_testing_system_extensions"
      ],
      "traits": [
        {
          "interfaceLanguage": "swift"
        }
      ]
    }
  ]
}
